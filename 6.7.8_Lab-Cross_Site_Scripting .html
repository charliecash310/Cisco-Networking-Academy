<!DOCTYPE html><html><head>
<style>
      body {
        font-family: Arial, sans-serif;
        margin: 1rem;
      }
      ol,
      ul {
        margin-bottom: 0in;
      }
      table {
        margin-top: 1rem;
        border: 1px solid gray;
        width: 7in;
        border-collapse: collapse;
      }

      table > thead > tr > .openTableTextBox__table-header-data {
        text-align: center;
        margin-top: 6pt;
        margin-right: 0in;
        margin-bottom: 6pt;
        margin-left: 0in;
        text-align: center;
        line-height: 115%;
        page-break-after: avoid;
        font-size: 10pt;
        font-family: "Arial", sans-serif;
        font-weight: bold;
        background: #dbe5f1;
        padding: 0.5rem;
      }
      .openTableTextBox__answerText
        table
        > thead
        > tr
        > .openTableTextBox__table-header-data {
        background: #f2dbdb !important;
      }
      .openTextBox__textArea-container {
        margin-top: 6pt;
        margin-right: 0in;
        margin-bottom: 6pt;
        font-size: 10pt;
        font-family: "Arial", sans-serif;
        width: 50%;
      }
      .openTableTextBox__fieldset {
        padding: 5px;
      }
      td {
        margin-top: 3pt;
        margin-right: 0in;
        margin-bottom: 3pt;
        margin-left: 0in;
        font-size: 10pt;
        font-family: "Arial", sans-serif;
        width: 98.85pt;
        border: solid windowtext 1pt;
        border-top: none;
        padding: 0.7pt 5.75pt 0.7pt 5.75pt;
      }
      textarea {
        width: 100%;
      }
      .answergray {
        padding: 0.2rem;
      }

      .openTableTextBox__widget {
        margin-top: 6pt;
        margin-right: 0in;
        margin-bottom: 6pt;
        margin-left: 0.25in;
      }

      .show-answer,
      .hide-answer {
        padding: 0.5rem 1rem;
        background-color: #3d692b;
        color: #fff;
        border: 0px;
        cursor: pointer;
        margin-bottom: 0.5rem;
        margin-top: 0.5rem;
      }

      .openTextBoxController__button-container {
        display: flex;
        margin-top: 1rem;
        margin-bottom: 1rem;
      }

      .openTextBoxController__button-container .btn-text {
        margin: 10px;
      }

      .btn-text {
        border: 0px;
        padding: 0.5rem 1rem;
        background-color: #3d692b;
        color: #fff;
        border-radius: 0;
        cursor: pointer;
      }

      .u-display-none {
        display: none;
      }
      .openTextBox__postText, openTableTextBox__postText {
        margin-top: 0.5rem;
      }
      .edit-comment {
        display: none;
      }
      .js-heading-inner {
        display: none;
      }
      .block__title-inner,
      .article__title-inner {
        display: block;
        font-size: 1.5em;
        margin-block-start: 0.83em;
        margin-block-end: 0.83em;
        margin-inline-start: 0px;
        margin-inline-end: 0px;
        font-weight: bold;
      }
      h2{
        font-size: 1.25em;
      }
      h3{
        font-size: 1.125em;
      }
      .table
        > .table-inner
        > .table-wrapper
        > .table-widget
        > table
        > tbody
        > tr
        > th {
        border: solid windowtext 1pt;
      }
      .openTableTextBox__answerText
        table
        > thead
        > tr
        > .openTableTextBox__table-header-data {
        background: #f2dbdb !important;
      }
      .command-output > .table-inner > .table-wrapper > .table-widget > table,
      .command-output
        > .table-inner
        > .table-wrapper
        > .table-widget
        > table
        > tbody
        > tr
        > td,
      .command-output
        > .table-inner
        > .table-wrapper
        > .table-widget
        > table
        > tbody
        > tr
        > th {
        border: none !important;
        text-align: right !important;
      }
      .simple-table > .table-inner > .table-wrapper{
        margin-left: 1.5rem;
      }
      .openTextBox__widget {
        margin-left: 1.5rem;
      }
      img {
        width: 30%;
        height: auto;
        margin-top: 1rem;
        margin-left: 3rem;
      }
      .answergray {
        background-color: #ccc;
      }
      .openTableTextBox__widget > .answergray {
        background-color: #fff !important;
      }
      li > ul,ol > li{
        margin-left: 0px !important;
      }
      img {
        width: 30%;
        height: auto;
        margin-top: 1rem;
        margin-left: 3rem;
      }

      .accessibility-completion-indicator{
        display: none;
      }
    </style>

</head><body><!---->
            <div class="article 648ba1fef756a2285cdd4ff4 remove-top-padding remove-padding-bottom background-color-white ">
                <div class="article__inner">
                <div class=" no-adaptive-scroll">
                    <!--?lit$370482686$-->
                        <div class=""> 
                            <base-view type="article" model="[object Object]" customclass="" lowercase_component="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="article__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="article__header ">
              <div class="article__header-inner ">
                  
                    <!--?lit$370482686$--> <div class=" article__title ">
                      <!--?lit$370482686$--><heading-view aria-hidden="true" id="648ba1fef756a2285cdd4ff4-heading-view" headingtitle="Lab - Cross Site Scripting" modelid="648ba1fef756a2285cdd4ff4" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="js-heading is-incomplete">
        <div class="js-heading-inner" role="heading" id="article-heading" aria-level="2">
        <span class="aria-label"> <!--?lit$370482686$-->Incomplete &nbsp;<!--?lit$370482686$-->Lab - Cross Site Scripting</span>
        </div>
      </div>
    </heading-view>
                        <div tabindex="0" role="heading" class="article__title-inner " aria-level="2">
                        <span class="accessibility-completion-indicator"><!--?lit$370482686$-->Incomplete </span>
                        <!--?lit$370482686$-->Lab - Cross Site Scripting</div>
                      </div>
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
                            <div class="block__container " style="">
                                <!--?lit$370482686$--><!---->
                                    <block-view modelid="648ba1fef756a2285cdd4ff5" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="block" style="width: 5%;"><!---->
                
                <div data-socialgoodpulse-id="648ba1fef756a2285cdd4ff5" class="648ba1fef756a2285cdd4ff5 block remove-top-padding remove-padding-bottom background-color-white is-complete">
                    <div class="block__inner">    
                    <base-view type="block" modelid="648ba1fef756a2285cdd4ff5" model="[object Object]" customclass="" lowercase_component="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="block__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="block__header ">
              <div class="block__header-inner ">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
                        <div class="component__container">                            
                                <!--?lit$370482686$--><!----><text-view modelid="648ba1fff756a2285cdd5011" class="is-full remove-top-padding remove-padding-bottom background-color-white" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="component"><!---->
        <div class="component__header-container">
            <div data-socialgoodpulse-id="648ba1fff756a2285cdd5011" class="component text 648ba1fff756a2285cdd5011 remove-top-padding remove-padding-bottom background-color-white is-full is-complete  ">
                <base-view type="component" lowercase_component="text" model="[object Object]" customclass="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="component__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="component__header text__header">
              <div class="component__header-inner text__header-inner">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$--> <div class="component__content">
                      <div tabindex="0" class="component__body text__body">
                        <div class="component__body-inner text__body-inner"><!--?lit$370482686$--><h1>Objectives</h1><p>In this lab, you will perform Reflected XSS and Stored XSS attacks against the DVWA (Damn Vulnerable Web Application!) at low, medium, and high security levels.</p><p><!--[if !supportLists]--></p><ul><li><!--[if !supportLists]--><!--[endif]-->Part 1: Perform Reflective Cross Site Scripting Exploits</li><li><!--[if !supportLists]--><!--[endif]-->Part 2: Perform Stored Cross Site Scripting Exploits</li></ul><p>&nbsp;</p><h1>Background / Scenario</h1><p>In this lab, you will perform penetration tests of a web application to determine if it has been securely designed.</p><p>DVWA (Damn Vulnerable Web Application!) is a PHP/MySQL web application. It is designed to be vulnerable to common attacks to allow security professionals to test their skills and tools and students and teachers to learn and understand web application security in a legal environment.</p><p>DVWA provides four levels of security: Low, Medium, High, and Impossible. Each security level requires different skills to perform exploits. The security levels reflect different levels of security that developers may code into their applications. In this lab, you will perform exploits against three of the security levels, Low, Medium, and High, allowing you to adjust your attacks to compromise them.</p><h1>Required Resources</h1><p><!--[if !supportLists]--><!--[endif]--></p><ul><li><!--[if !supportLists]--><!--[endif]-->Kali VM customized for the Ethical Hacker course</li><li><!--[if !supportLists]--><!--[endif]-->Internet access</li></ul></div>
                      </div>
                    </div>
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
            </div>
        </div>

        <!-- div><div class="component__inner"></div></div -->
        </text-view><!---->
                            </div>                     
                    </div>
                </div>
            </block-view>
                                <!----><!---->
                                    <block-view modelid="648ba1fef756a2285cdd4ff6" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="block" style="width: 5%;"><!---->
                
                <div data-socialgoodpulse-id="648ba1fef756a2285cdd4ff6" class="648ba1fef756a2285cdd4ff6 block remove-top-padding remove-padding-bottom background-color-white is-complete">
                    <div class="block__inner">    
                    <base-view type="block" modelid="648ba1fef756a2285cdd4ff6" model="[object Object]" customclass="" lowercase_component="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="block__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="block__header ">
              <div class="block__header-inner ">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
                        <div class="component__container">                            
                                <!--?lit$370482686$--><!----><text-view modelid="648ba1fff756a2285cdd5012" class="is-full remove-top-padding remove-padding-bottom background-color-white" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="component"><!---->
        <div class="component__header-container">
            <div data-socialgoodpulse-id="648ba1fff756a2285cdd5012" class="component text 648ba1fff756a2285cdd5012 remove-top-padding remove-padding-bottom background-color-white is-full is-complete  ">
                <base-view type="component" lowercase_component="text" model="[object Object]" customclass="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="component__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="component__header text__header">
              <div class="component__header-inner text__header-inner">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$--> <div class="component__content">
                      <div tabindex="0" class="component__body text__body">
                        <div class="component__body-inner text__body-inner"><!--?lit$370482686$--><h1>Instructions</h1><h2 style="margin-left:0in"><!--[if !supportLists]--><span><span>Part 1: </span></span><!--[endif]-->Perform Reflective Cross Site Scripting Exploits</h2><p>A Reflected XSS attack is one in which a malicious script is reflected off a web server to the user's browser. The script is activated through a link that the victim clicks. This will send a request to the website that has a vulnerability that enables execution of the malicious script.</p><h3 style="margin-left:0in"><!--[if !supportLists]--><span><span>Step 1: </span></span><!--[endif]-->Log into DVWA.</h3><ol start="1" style="list-style-type:lower-alpha"><li>From the Kali Linux VM, open a browser and navigate to the DVWA application.</li><li><!--[if !supportLists]--><!--[endif]-->Enter the following URL into the browser <a href="http://10.6.6.13" target="_blank">http://10.6.6.13</a>.</li><li><!--[if !supportLists]--><!--[endif]-->At the login prompt, enter the credentials: <strong>admin</strong>/<strong>password</strong>.</li></ol></div>
                      </div>
                    </div>
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
            </div>
        </div>

        <!-- div><div class="component__inner"></div></div -->
        </text-view><!---->
                            </div>                     
                    </div>
                </div>
            </block-view>
                                <!----><!---->
                                    <block-view modelid="648ba1fef756a2285cdd4ffa" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="block" style="width: 5%;"><!---->
                
                <div data-socialgoodpulse-id="648ba1fef756a2285cdd4ffa" class="648ba1fef756a2285cdd4ffa block remove-top-padding remove-padding-bottom background-color-white ">
                    <div class="block__inner">    
                    <base-view type="block" modelid="648ba1fef756a2285cdd4ffa" model="[object Object]" customclass="" lowercase_component="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="block__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="block__header ">
              <div class="block__header-inner ">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
                        <div class="component__container">                            
                                <!--?lit$370482686$--><!----><text-view modelid="648ba1fff756a2285cdd5016" class="is-full remove-top-padding remove-padding-bottom background-color-white" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="component"><!---->
        <div class="component__header-container">
            <div data-socialgoodpulse-id="648ba1fff756a2285cdd5016" class="component text 648ba1fff756a2285cdd5016 remove-top-padding remove-padding-bottom background-color-white is-full   ">
                <base-view type="component" lowercase_component="text" model="[object Object]" customclass="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="component__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="component__header text__header">
              <div class="component__header-inner text__header-inner">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$--> <div class="component__content">
                      <div tabindex="0" class="component__body text__body">
                        <div class="component__body-inner text__body-inner"><!--?lit$370482686$--><h3 style="margin-left:0in"><!--[if !supportLists]--><span><span>Step 2: </span></span><!--[endif]-->Perform a Reflected XSS attack at Low security level.</h3><ol start="1" style="list-style-type: lower-alpha;"><li><!--[if !supportLists]-->Select <strong>DVWA Security</strong> in the left menu and select <strong>Low</strong> in the Security Level dropdown. Click <strong>Submit</strong>.</li><li><!--[if !supportLists]--><!--[endif]-->Select <strong>XSS (Reflected)</strong> from the left menu.</li><li><!--[if !supportLists]--><!--[endif]-->Type the string <strong>Reflected_Test</strong> in the <strong>What's your name?</strong> box and click <strong>Submit</strong>.</li></ol><p style="margin-left: 40px;">You will see the message <span class="BodyTextL25Char"><strong>Hello Reflected_Test</strong></span> appear.</p><ol start="4" style="list-style-type: lower-alpha;"><li><!--[if !supportLists]-->Enter <strong>CTRL+U</strong> on the keyboard to view the source code of the page.</li><li><!--[if !supportLists]-->Search for the string <strong>Hello Reflected_Test</strong> by entering CTRL+F to open a search box.</li></ol><p style="margin-left: 40px;">The presence of the string in the page source HTML indicates that values entered in a user response text field are inserted into the source code for the page. This indicates to an attacker that the page may be vulnerable to reflected XSS attacks.</p><ol start="6" style="list-style-type: lower-alpha;"><li><!--[if !supportLists]--><!--[endif]-->Close the source code window and return to the Reflected XSS Vulnerability page.</li><li><!--[if !supportLists]-->Enter the following payload in the <strong>What’s your name?</strong> box and click <strong>Submit</strong>.</li></ol><pre style="margin-left: 1in;"><strong>&lt;script&gt;alert("You are hacked!")&lt;/script&gt;</strong></pre><p style="margin-left: 40px;">An alert popup box will appear with the words <strong>You are hacked!</strong>. This means the site is vulnerable to Reflected XSS attacks and we have successfully exploited the vulnerability.</p><ol start="8" style="list-style-type: lower-alpha;"><li><!--[if !supportLists]--><!--[endif]-->Select and copy the URL for the compromised page. Open a new browser tab and paste the URL into the URL field and press &lt;Enter&gt;.</li></ol><p style="margin-left: 40px;">You should see the same web page appear displaying the <strong>You are hacked</strong>! popup box. This means that if a user opens the URL a malicious script will execute. The alert box is used to simulate a malicious script in this lab.</p><p style="margin-left: 40px;">In an ethical hacking engagement, you would try inserting a simple test script into input fields to see if the script executes. If so, the website is vulnerable to reflected XSS attacks. You could then distribute the link in a phishing attack to determine the level of security awareness among your customers’ employees.</p></div>
                      </div>
                    </div>
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
            </div>
        </div>

        <!-- div><div class="component__inner"></div></div -->
        </text-view><!---->
                            </div>                     
                    </div>
                </div>
            </block-view>
                                <!----><!---->
                                    <block-view modelid="648ba1fef756a2285cdd4ffb" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="block" style="width: 5%;"><!---->
                
                <div data-socialgoodpulse-id="648ba1fef756a2285cdd4ffb" class="648ba1fef756a2285cdd4ffb block remove-top-padding remove-padding-bottom background-color-white ">
                    <div class="block__inner">    
                    <base-view type="block" modelid="648ba1fef756a2285cdd4ffb" model="[object Object]" customclass="" lowercase_component="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="block__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="block__header ">
              <div class="block__header-inner ">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
                        <div class="component__container">                            
                                <!--?lit$370482686$--><!----><text-view modelid="648ba1fff756a2285cdd5017" class="is-full remove-top-padding remove-padding-bottom background-color-white" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="component"><!---->
        <div class="component__header-container">
            <div data-socialgoodpulse-id="648ba1fff756a2285cdd5017" class="component text 648ba1fff756a2285cdd5017 remove-top-padding remove-padding-bottom background-color-white is-full   ">
                <base-view type="component" lowercase_component="text" model="[object Object]" customclass="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="component__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="component__header text__header">
              <div class="component__header-inner text__header-inner">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$--> <div class="component__content">
                      <div tabindex="0" class="component__body text__body">
                        <div class="component__body-inner text__body-inner"><!--?lit$370482686$--><h3 style="margin-left:0in"><!--[if !supportLists]--><span><span>Step 3: </span></span><!--[endif]-->Perform a Reflected XSS attack at Medium security level.</h3><p>You will attempt the same attack, but this time the security level of the Web site will Medium.</p><ol start="1" style="list-style-type:lower-alpha"><li><!--[if !supportLists]-->Select <strong>DVWA Security</strong> in the left menu and select <strong>Medium</strong> in the Security Level dropdown. Click <strong>Submit</strong>.</li><li><!--[if !supportLists]-->Select <strong>XSS (Reflected)</strong> in the left menu.</li><li><!--[if !supportLists]-->Again, enter the following payload in the <strong>What's your name?</strong> box and click <strong>Submit</strong>.</li></ol><pre style="margin-left:1in"><strong>&lt;script&gt;alert("You are hacked!")&lt;/script&gt;</strong></pre><p style="margin-left:40px">You will see a Hello response, but this time no pop up will appear. This indicates that the script did not execute. Note that the script is displayed as literal text.</p><p style="margin-left:40px">We can analyze the code in the backend of the web site to investigate the reason.</p><ol start="4" style="list-style-type:lower-alpha"><li><!--[if !supportLists]--><!--[endif]-->Click the <strong>View Source</strong> button on the bottom right of the page and review the PHP code.</li></ol><p style="margin-left:40px"><strong>Note</strong>: On a real web server, we would not have access to this backend source code, but here on DVWS we do.</p><ol start="5" style="list-style-type:lower-alpha"><li><!--[if !supportLists]-->Note the line:</li></ol><pre style="margin-left:80px"><strong><span>$name = str_replace ( '&lt;script&gt;', '',<span>  </span>$_GET[ 'name' ] );</span></strong></pre><p style="margin-left:40px"><span>This source code creates a filter, with </span><strong>str_replace()</strong><span> function, that removes the </span><strong>&lt;script&gt;</strong><span> tag in our payload and replaces it with a null value. This renders the payload script ineffective, so the attack failed, and no popup window is displayed. Because this script is only filtering out &lt;script&gt; in lower case, we can try and get around the filter by using a different tag in the payload. We will use </span><strong>&lt;ScRipt&gt;</strong>.</p><ol start="6" style="list-style-type:lower-alpha"><li><!--[if !supportLists]--><!--[endif]-->Close the source code window and return to the Reflected XSS Vulnerability page.</li><li><!--[if !supportLists]--><!--[endif]-->Enter the following payload in the <strong>What's your name?</strong> box and click <strong>Submit</strong>.</li></ol><pre style="margin-left:80px"><strong>&lt;ScRipt&gt;alert("You are hacked!")&lt;/ScRipt&gt;</strong></pre></div>
                      </div>
                    </div>
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
            </div>
        </div>

        <!-- div><div class="component__inner"></div></div -->
        </text-view><!---->
                            </div>                     
                    </div>
                </div>
            </block-view>
                                <!----><!---->
                                    <block-view modelid="648cab7e2c1a5d29dfc18659" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="block" style="width: 5%;"><!---->
                
                <div data-socialgoodpulse-id="648cab7e2c1a5d29dfc18659" class="648cab7e2c1a5d29dfc18659 block remove-top-padding remove-padding-bottom background-color-white ">
                    <div class="block__inner">    
                    <base-view type="block" modelid="648cab7e2c1a5d29dfc18659" model="[object Object]" customclass="" lowercase_component="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="block__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="block__header ">
              <div class="block__header-inner ">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
                        <div class="component__container">                            
                                <!--?lit$370482686$--><!----><opentextbox-view modelid="648caba6189da229eda7dbf5" class="is-full remove-top-padding remove-padding-bottom background-color-white" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="component"><!---->
        <div class="component">
          <div class="component__inner openTextBox__inner">
            <div data-socialgoodpulse-id="648caba6189da229eda7dbf5" class="component opentextbox 648caba6189da229eda7dbf5 remove-top-padding remove-padding-bottom background-color-white is-full   ">
              <div class="component__header-container">
                <div data-socialgoodpulse-id="648caba6189da229eda7dbf5" class="opentabletextbox remove-top-padding remove-padding-bottom background-color-white">
                  <base-view type="component" lowercase_component="openTextBox" model="[object Object]" customclass="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="component__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="component__header openTextBox__header">
              <div class="component__header-inner openTextBox__header-inner">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
                </div>
              </div>
                  <div class="component__widget openTextBox__widget question-container">
                      <!--?lit$370482686$--> <div class="openTextBox__preText"><!--?lit$370482686$-->Did the popup alert appear? If so, why?</div>                         
      
                      <div class="openTextBox__textArea-container">
                          <fieldset class="openTextBox__fieldset" tabindex="0">
                          <legend class="openTextBox__legend">
                            <!--?lit$370482686$-->Answer Area
                          </legend>
                          <textarea class="openTextBox__textArea" rows="3" name="answerArea" placeholder="Enter your answer here" aria-label="Enter your answer here">&lt;!----&gt;&lt;!----&gt;</textarea>
                          </fieldset>
                      </div>
                      <div class="openTextBox__answerText answergray  hide">
                        <!--?lit$370482686$-->
                      <!--?lit$370482686$-->The popup did appear because the payload with the &lt;ScRipt&gt; tag was able to bypass the filter. This means the site is still vulnerable to Reflected XSS attacks even at the Medium security level.
                    </div>

                      <div class="btn__container">                        
                        <!--?lit$370482686$-->                    
                      </div>
                      <!--?lit$370482686$--><!--?-->  
                  </div>
              </div>
            </div>
          </div>
        
      </opentextbox-view><!---->
                            </div>                     
                    </div>
                </div>
            </block-view>
                                <!----><!---->
                                    <block-view modelid="648ba1fef756a2285cdd4ffc" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="block" style="width: 5%;"><!---->
                
                <div data-socialgoodpulse-id="648ba1fef756a2285cdd4ffc" class="648ba1fef756a2285cdd4ffc block remove-top-padding remove-padding-bottom background-color-white ">
                    <div class="block__inner">    
                    <base-view type="block" modelid="648ba1fef756a2285cdd4ffc" model="[object Object]" customclass="" lowercase_component="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="block__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="block__header ">
              <div class="block__header-inner ">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
                        <div class="component__container">                            
                                <!--?lit$370482686$--><!----><text-view modelid="648ba1fff756a2285cdd5018" class="is-full remove-top-padding remove-padding-bottom background-color-white" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="component"><!---->
        <div class="component__header-container">
            <div data-socialgoodpulse-id="648ba1fff756a2285cdd5018" class="component text 648ba1fff756a2285cdd5018 remove-top-padding remove-padding-bottom background-color-white is-full   ">
                <base-view type="component" lowercase_component="text" model="[object Object]" customclass="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="component__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="component__header text__header">
              <div class="component__header-inner text__header-inner">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$--> <div class="component__content">
                      <div tabindex="0" class="component__body text__body">
                        <div class="component__body-inner text__body-inner"><!--?lit$370482686$--><h3 style="margin-left:0in"><!--[if !supportLists]--><span><span>Step 4: </span></span><!--[endif]-->Perform a Reflective XSS attack at High security level.</h3><p>The same attack will be attempted, but this time the security level of the website will be High.</p><ol start="1" style="list-style-type:lower-alpha"><li><!--[if !supportLists]-->Select <strong>DVWA Security</strong> in the left menu and select <strong>High</strong> in the Security Level dropdown. Click <strong>Submit</strong>.</li><li><!--[if !supportLists]-->Select <strong>XSS (Reflected)</strong> in the left menu.</li><li><!--[if !supportLists]-->Enter the following payload in the <strong>What's your name?</strong> box and click <strong>Submit</strong>. <span>(Note the use of underscores to replace spaces.)</span></li></ol><pre style="margin-left:1in"><strong>&lt;ScRipt&gt;alert("You_are_hacked!")&lt;/ScRipt&gt;</strong></pre><p style="margin-left:40px">There is a Hello message and no alert pop up box. Again, we can analyze the backend source code to investigate.</p><ol start="4" style="list-style-type:lower-alpha"><li><!--[if !supportLists]-->Click the <strong>View Source</strong> button and review the PHP code.</li></ol><p style="margin-left:40px">Note the following line:</p><pre style="margin-left:80px"><strong>$name = preg_replace( '/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i', '', $_GET[ 'name' ] );</strong></pre><p style="margin-left:40px"><span>In this code, the developer used a regular expression to replace any form of the </span><strong><span>&lt;script&gt;</span></strong><span> tag, no matter what case of the characters is used, with a null value.</span></p></div>
                      </div>
                    </div>
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
            </div>
        </div>

        <!-- div><div class="component__inner"></div></div -->
        </text-view><!---->
                            </div>                     
                    </div>
                </div>
            </block-view>
                                <!----><!---->
                                    <block-view modelid="648ba1fef756a2285cdd5000" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="block" style="width: 5%;"><!---->
                
                <div data-socialgoodpulse-id="648ba1fef756a2285cdd5000" class="648ba1fef756a2285cdd5000 block remove-top-padding remove-padding-bottom background-color-white ">
                    <div class="block__inner">    
                    <base-view type="block" modelid="648ba1fef756a2285cdd5000" model="[object Object]" customclass="" lowercase_component="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="block__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="block__header ">
              <div class="block__header-inner ">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
                        <div class="component__container">                            
                                <!--?lit$370482686$--><!----><opentextbox-view modelid="648ba200f756a2285cdd501c" class="is-full" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="component"><!---->
        <div class="component">
          <div class="component__inner openTextBox__inner">
            <div data-socialgoodpulse-id="648ba200f756a2285cdd501c" class="component opentextbox 648ba200f756a2285cdd501c  is-full   ">
              <div class="component__header-container">
                <div data-socialgoodpulse-id="648ba200f756a2285cdd501c" class="opentabletextbox ">
                  <base-view type="component" lowercase_component="openTextBox" model="[object Object]" customclass="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="component__header-wrapper  ">
        <div class="component__header openTextBox__header">
              <div class="component__header-inner openTextBox__header-inner">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
                </div>
              </div>
                  <div class="component__widget openTextBox__widget question-container">
                      <!--?lit$370482686$--> <div class="openTextBox__preText"><!--?lit$370482686$-->Which character in the script was omitted from the regular expression? How do you know?</div>                         
      
                      <div class="openTextBox__textArea-container">
                          <fieldset class="openTextBox__fieldset" tabindex="0">
                          <legend class="openTextBox__legend">
                            <!--?lit$370482686$-->Answer Area
                          </legend>
                          <textarea class="openTextBox__textArea" rows="3" name="answerArea" placeholder="Enter your answer here" aria-label="Enter your answer here">&lt;!----&gt;&lt;!----&gt;</textarea>
                          </fieldset>
                      </div>
                      <div class="openTextBox__answerText answergray  hide">
                        <!--?lit$370482686$-->
                      <!--?lit$370482686$-->The “&gt;” character was omitted. You can still see it in the output for the submitted “What’s your name?” input.
                    </div>

                      <div class="btn__container">                        
                        <!--?lit$370482686$-->                    
                      </div>
                      <!--?lit$370482686$--><!--?-->  
                  </div>
              </div>
            </div>
          </div>
        
      </opentextbox-view><!---->
                            </div>                     
                    </div>
                </div>
            </block-view>
                                <!----><!---->
                                    <block-view modelid="648ba1fef756a2285cdd5001" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="block" style="width: 5%;"><!---->
                
                <div data-socialgoodpulse-id="648ba1fef756a2285cdd5001" class="648ba1fef756a2285cdd5001 block remove-top-padding remove-padding-bottom background-color-white ">
                    <div class="block__inner">    
                    <base-view type="block" modelid="648ba1fef756a2285cdd5001" model="[object Object]" customclass="" lowercase_component="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="block__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="block__header ">
              <div class="block__header-inner ">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
                        <div class="component__container">                            
                                <!--?lit$370482686$--><!----><text-view modelid="648bba01cebe6e27b9c9e27a" class="is-full remove-top-padding remove-padding-bottom background-color-white" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="component"><!---->
        <div class="component__header-container">
            <div data-socialgoodpulse-id="648bba01cebe6e27b9c9e27a" class="component text 648bba01cebe6e27b9c9e27a remove-top-padding remove-padding-bottom background-color-white is-full   ">
                <base-view type="component" lowercase_component="text" model="[object Object]" customclass="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="component__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="component__header text__header">
              <div class="component__header-inner text__header-inner">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$--> <div class="component__content">
                      <div tabindex="0" class="component__body text__body">
                        <div class="component__body-inner text__body-inner"><!--?lit$370482686$--><ol start="5" style="list-style-type:lower-alpha"><li><!--[if !supportLists]-->To bypass this filter, we must use another HTML tag instead of <strong>&lt;script&gt;</strong> to attack the site.</li></ol><p style="margin-left:40px">Close the source code window and return to the Reflected XSS Vulnerability page.</p><ol start="6" style="list-style-type:lower-alpha"><li><!--[if !supportLists]--><!--[endif]-->Enter the following payload in the <strong>What's your name?</strong> box and click <strong>Submit</strong>. <span>(Note the use of underscores to replace spaces.)</span></li></ol><p style="margin-left:80px"><strong>&lt;img src=x onerror=alert("You_are_hacked!")&gt;</strong></p><p style="margin-left:40px">The XSS popup box will appear this time. We successfully bypassed the filter and exploited the Reflected XSS vulnerability in DVWA at High level security.</p></div>
                      </div>
                    </div>
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
            </div>
        </div>

        <!-- div><div class="component__inner"></div></div -->
        </text-view><!---->
                            </div>                     
                    </div>
                </div>
            </block-view>
                                <!----><!---->
                                    <block-view modelid="648ba1fef756a2285cdd4ffe" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="block" style="width: 5%;"><!---->
                
                <div data-socialgoodpulse-id="648ba1fef756a2285cdd4ffe" class="648ba1fef756a2285cdd4ffe block remove-top-padding remove-padding-bottom background-color-white ">
                    <div class="block__inner">    
                    <base-view type="block" modelid="648ba1fef756a2285cdd4ffe" model="[object Object]" customclass="" lowercase_component="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="block__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="block__header ">
              <div class="block__header-inner ">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
                        <div class="component__container">                            
                                <!--?lit$370482686$--><!----><opentextbox-view modelid="648bba68ac937e28ca8d68bf" class="is-full" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="component"><!---->
        <div class="component">
          <div class="component__inner openTextBox__inner">
            <div data-socialgoodpulse-id="648bba68ac937e28ca8d68bf" class="component opentextbox 648bba68ac937e28ca8d68bf  is-full   ">
              <div class="component__header-container">
                <div data-socialgoodpulse-id="648bba68ac937e28ca8d68bf" class="opentabletextbox ">
                  <base-view type="component" lowercase_component="openTextBox" model="[object Object]" customclass="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="component__header-wrapper  ">
        <div class="component__header openTextBox__header">
              <div class="component__header-inner openTextBox__header-inner">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
                </div>
              </div>
                  <div class="component__widget openTextBox__widget question-container">
                      <!--?lit$370482686$--> <div class="openTextBox__preText"><!--?lit$370482686$-->Review the text that you input into the web form. How did it work?</div>                         
      
                      <div class="openTextBox__textArea-container">
                          <fieldset class="openTextBox__fieldset" tabindex="0">
                          <legend class="openTextBox__legend">
                            <!--?lit$370482686$-->Answer Area
                          </legend>
                          <textarea class="openTextBox__textArea" rows="3" name="answerArea" placeholder="Enter your answer here" aria-label="Enter your answer here">&lt;!----&gt;&lt;!----&gt;</textarea>
                          </fieldset>
                      </div>
                      <div class="openTextBox__answerText answergray  hide">
                        <!--?lit$370482686$-->
                      <!--?lit$370482686$-->It forced an error to occur by attempting to load a non-existent image. The error was detected with onerror and the alert response was triggered to display the alert box. 
                    </div>

                      <div class="btn__container">                        
                        <!--?lit$370482686$-->                    
                      </div>
                      <!--?lit$370482686$--><!--?-->  
                  </div>
              </div>
            </div>
          </div>
        
      </opentextbox-view><!---->
                            </div>                     
                    </div>
                </div>
            </block-view>
                                <!----><!---->
                                    <block-view modelid="648ba1fef756a2285cdd5003" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="block" style="width: 5%;"><!---->
                
                <div data-socialgoodpulse-id="648ba1fef756a2285cdd5003" class="648ba1fef756a2285cdd5003 block remove-top-padding remove-padding-bottom background-color-white ">
                    <div class="block__inner">    
                    <base-view type="block" modelid="648ba1fef756a2285cdd5003" model="[object Object]" customclass="" lowercase_component="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="block__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="block__header ">
              <div class="block__header-inner ">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
                        <div class="component__container">                            
                                <!--?lit$370482686$--><!----><text-view modelid="648bba98ac937e28ca8d68c1" class="is-full remove-top-padding remove-padding-bottom background-color-white" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="component"><!---->
        <div class="component__header-container">
            <div data-socialgoodpulse-id="648bba98ac937e28ca8d68c1" class="component text 648bba98ac937e28ca8d68c1 remove-top-padding remove-padding-bottom background-color-white is-full   ">
                <base-view type="component" lowercase_component="text" model="[object Object]" customclass="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="component__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="component__header text__header">
              <div class="component__header-inner text__header-inner">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$--> <div class="component__content">
                      <div tabindex="0" class="component__body text__body">
                        <div class="component__body-inner text__body-inner"><!--?lit$370482686$--><h2 style="margin-left:0in"><!--[if !supportLists]--><span><span>Part 2: </span></span><!--[endif]-->Perform Stored Cross Site Scripting Exploits</h2><p>With the <span class="BodyTextL50Char">stored </span>XSS exploit, you enter a malicious script through user input and the script is stored on the target server in a message forum, database, visitor log, or comment field. When a user visits the target, the server exposes the user to the malicious code.</p><h3 style="margin-left:0in"><!--[if !supportLists]--><span><span>Step 1: </span></span><!--[endif]-->Perform a Stored XSS attack at Low security level.</h3><p>Exploiting stored XSS at low level security is easy because there are no security measures in place. You can simply submit a &lt;script&gt; to achieve the exploit.</p><ol start="1" style="list-style-type:lower-alpha"><li><!--[if !supportLists]-->Select <strong>DVWA Security</strong> in the left menu and select <strong>Low</strong> in the Security Level dropdown. Click <strong>Submit</strong>.</li><li><!--[if !supportLists]--><!--[endif]-->Select <strong>XSS (Stored)</strong> in the left menu.</li><li><!--[if !supportLists]-->Type the string <strong>XSS Test#1</strong> in the <strong>Name*</strong> field and type <strong>Stored XSS Test</strong> in the <strong>Message *</strong> field. click <strong>Sign Guestbook</strong>.</li><li><!--[if !supportLists]--><!--[endif]-->Enter <strong>CTRL+U</strong> on the keyboard to view the page source code. Enter <strong>CTRL+F</strong> to search for the <strong>Test#1 </strong><span>and </span><strong>Stored XSS Test</strong> strings.</li></ol><p style="margin-left:40px">Both strings, <strong>Test#1</strong> and <strong>Stored XSS Test</strong>, will be in the page source code indicating that the two input fields may be vulnerable to a Stored XSS attack.</p><ol start="5" style="list-style-type:lower-alpha"><li><!--[if !supportLists]-->Close the source code window and return to the Stored XSS Vulnerability page.</li><li><!--[if !supportLists]-->Enter <strong>Test#1</strong> in the <strong>Name *</strong> box and enter the following payload in the <strong>Message *</strong> field and click <strong>Sign Guestbook</strong>.</li></ol><pre style="margin-left:1in"><strong>&lt;script&gt;alert("You are hacked!")&lt;/script&gt;</strong></pre><p style="margin-left:.5in">An XSS alert popup box will appear with the words <strong>You are hacked!</strong>. This means the site was vulnerable to stored XSS attacks and we have successfully exploited the vulnerability.</p><ol start="7" style="list-style-type:lower-alpha"><li><!--[if !supportLists]-->Refresh the page. If alerted, click <strong>Resend</strong> to display the page. The XSS alert popup box will appear again.</li></ol><p style="margin-left:40px">Because the XSS payload is stored in the guestbook, the alert popup box will appear each time the page is refreshed.</p><ol start="8" style="list-style-type:lower-alpha"><li><!--[if !supportLists]--><!--[endif]-->Before proceeding to the next step, clear the XSS payload from the page. Click<strong> Setup / Reset DB</strong> in the left menu then click <strong>Create / Reset Database</strong>.</li></ol></div>
                      </div>
                    </div>
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
            </div>
        </div>

        <!-- div><div class="component__inner"></div></div -->
        </text-view><!---->
                            </div>                     
                    </div>
                </div>
            </block-view>
                                <!----><!---->
                                    <block-view modelid="648ba1fff756a2285cdd5005" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="block" style="width: 5%;"><!---->
                
                <div data-socialgoodpulse-id="648ba1fff756a2285cdd5005" class="648ba1fff756a2285cdd5005 block remove-top-padding remove-padding-bottom background-color-white ">
                    <div class="block__inner">    
                    <base-view type="block" modelid="648ba1fff756a2285cdd5005" model="[object Object]" customclass="" lowercase_component="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="block__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="block__header ">
              <div class="block__header-inner ">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
                        <div class="component__container">                            
                                <!--?lit$370482686$--><!----><text-view modelid="648ba200f756a2285cdd5021" class="is-full remove-top-padding remove-padding-bottom background-color-white" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="component"><!---->
        <div class="component__header-container">
            <div data-socialgoodpulse-id="648ba200f756a2285cdd5021" class="component text 648ba200f756a2285cdd5021 remove-top-padding remove-padding-bottom background-color-white is-full   ">
                <base-view type="component" lowercase_component="text" model="[object Object]" customclass="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="component__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="component__header text__header">
              <div class="component__header-inner text__header-inner">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$--> <div class="component__content">
                      <div tabindex="0" class="component__body text__body">
                        <div class="component__body-inner text__body-inner"><!--?lit$370482686$--><h3 style="margin-left:0in"><!--[if !supportLists]--><span><span>Step 2: </span></span><!--[endif]-->Perform a Stored XSS attack at Medium security level.</h3><p>The same attack will be attempted, but this time the security level of the Web site will be changed to Medium.</p><p>Exploiting reflected XSS at medium level security is not difficult. Using &lt;script&gt; will be rejected but changing it to a different case such as &lt;ScRipt&gt; will bypass the security and achieve the exploit.</p><ol start="1" style="list-style-type: lower-alpha;"><li><!--[if !supportLists]-->Select <strong>DVWA Security</strong> in the left menu and select <strong>Medium</strong> in the Security Level options dropdown. Click <strong>Submit</strong>.</li><li><!--[if !supportLists]-->Select <strong>XSS (Stored)</strong> in the left menu.</li><li><!--[if !supportLists]-->Type the string <strong>XSS Test#1</strong> in the <strong>Name*</strong> field and type <strong>Stored XSS Test</strong> in the <strong>Message *</strong> field. click <strong>Sign Guestbook</strong>.</li><li><!--[if !supportLists]-->Enter <strong>CTRL+U</strong> on the keyboard to view the page source code. Enter <strong>CTRL+F</strong> to search for the <strong>Test#1</strong> and <strong>Stored XSS Test</strong> strings.</li></ol><p style="margin-left: 40px;">Both <span>strings will</span> be in the page source code indicating that the two input fields may be vulnerable to a Stored XSS attack.</p><ol start="5" style="list-style-type: lower-alpha;"><li><!--[if !supportLists]-->Close the source code window and return to the Vulnerability page.</li><li><!--[if !supportLists]--><!--[endif]-->Enter <strong>Test#1</strong> in the <strong>Name *</strong> box and enter the following payload in the <strong>Message *</strong> box and click <strong>Sign Guestbook</strong>.</li></ol><pre style="margin-left: 1in;"><strong>&lt;script&gt;alert("You are hacked!")&lt;/script&gt;</strong></pre><p style="margin-left: 40px;">No popup box should appear. Refreshing the page should not cause the alert popup box to appear either.</p><p style="margin-left: 40px;">This means that there is code in the backend that is sanitizing the user input from the <strong>Message *</strong> field to prevent scripts from being submitted. You can see the modified input in the last rectangle message box below the input fields.</p></div>
                      </div>
                    </div>
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
            </div>
        </div>

        <!-- div><div class="component__inner"></div></div -->
        </text-view><!---->
                            </div>                     
                    </div>
                </div>
            </block-view>
                                <!----><!---->
                                    <block-view modelid="648ba1fff756a2285cdd5006" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="block" style="width: 5%;"><!---->
                
                <div data-socialgoodpulse-id="648ba1fff756a2285cdd5006" class="648ba1fff756a2285cdd5006 block remove-top-padding remove-padding-bottom background-color-white ">
                    <div class="block__inner">    
                    <base-view type="block" modelid="648ba1fff756a2285cdd5006" model="[object Object]" customclass="" lowercase_component="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="block__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="block__header ">
              <div class="block__header-inner ">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
                        <div class="component__container">                            
                                <!--?lit$370482686$--><!----><opentextbox-view modelid="648ba200f756a2285cdd5022" class="is-full remove-top-padding remove-padding-bottom background-color-white" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="component"><!---->
        <div class="component">
          <div class="component__inner openTextBox__inner">
            <div data-socialgoodpulse-id="648ba200f756a2285cdd5022" class="component opentextbox 648ba200f756a2285cdd5022 remove-top-padding remove-padding-bottom background-color-white is-full   ">
              <div class="component__header-container">
                <div data-socialgoodpulse-id="648ba200f756a2285cdd5022" class="opentabletextbox remove-top-padding remove-padding-bottom background-color-white">
                  <base-view type="component" lowercase_component="openTextBox" model="[object Object]" customclass="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="component__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="component__header openTextBox__header">
              <div class="component__header-inner openTextBox__header-inner">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
                </div>
              </div>
                  <div class="component__widget openTextBox__widget question-container">
                      <!--?lit$370482686$--> <div class="openTextBox__preText"><!--?lit$370482686$-->How did the input filter script modify the input?</div>                         
      
                      <div class="openTextBox__textArea-container">
                          <fieldset class="openTextBox__fieldset" tabindex="0">
                          <legend class="openTextBox__legend">
                            <!--?lit$370482686$-->Answer Area
                          </legend>
                          <textarea class="openTextBox__textArea" rows="3" name="answerArea" placeholder="Enter your answer here" aria-label="Enter your answer here">&lt;!----&gt;&lt;!----&gt;</textarea>
                          </fieldset>
                      </div>
                      <div class="openTextBox__answerText answergray  hide">
                        <!--?lit$370482686$-->
                      <!--?lit$370482686$-->It removed the html &lt;script&gt; tags and added slashes.
                    </div>

                      <div class="btn__container">                        
                        <!--?lit$370482686$-->                    
                      </div>
                      <!--?lit$370482686$--><!--?-->  
                  </div>
              </div>
            </div>
          </div>
        
      </opentextbox-view><!---->
                            </div>                     
                    </div>
                </div>
            </block-view>
                                <!----><!---->
                                    <block-view modelid="648ba1fff756a2285cdd5007" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="block" style="width: 5%;"><!---->
                
                <div data-socialgoodpulse-id="648ba1fff756a2285cdd5007" class="648ba1fff756a2285cdd5007 block remove-top-padding remove-padding-bottom background-color-white ">
                    <div class="block__inner">    
                    <base-view type="block" modelid="648ba1fff756a2285cdd5007" model="[object Object]" customclass="" lowercase_component="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="block__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="block__header ">
              <div class="block__header-inner ">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
                        <div class="component__container">                            
                                <!--?lit$370482686$--><!----><text-view modelid="648ba200f756a2285cdd5023" class="is-full remove-top-padding remove-padding-bottom background-color-white" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="component"><!---->
        <div class="component__header-container">
            <div data-socialgoodpulse-id="648ba200f756a2285cdd5023" class="component text 648ba200f756a2285cdd5023 remove-top-padding remove-padding-bottom background-color-white is-full   ">
                <base-view type="component" lowercase_component="text" model="[object Object]" customclass="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="component__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="component__header text__header">
              <div class="component__header-inner text__header-inner">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$--> <div class="component__content">
                      <div tabindex="0" class="component__body text__body">
                        <div class="component__body-inner text__body-inner"><!--?lit$370482686$--><ol start="7" style="list-style-type: lower-alpha;"><li><!--[if !supportLists]-->Click the <strong>View Source</strong> button and review the PHP source code and investigate.</li></ol><p style="margin-left: 40px;">You will see two blocks of code with the word <strong>Sanitize</strong>. The first block of code, under <strong>// Sanitize message input</strong>, contains two PHP functions for performing input sanitization. The <strong>strip_tags()</strong> function removes all html tags from the message field before storing them in the database. The <strong>htmlspecialchars()</strong> function converts all special characters into equivalent HTML entities so they are not reflected back in the browser.</p></div>
                      </div>
                    </div>
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
            </div>
        </div>

        <!-- div><div class="component__inner"></div></div -->
        </text-view><!---->
                            </div>                     
                    </div>
                </div>
            </block-view>
                                <!----><!---->
                                    <block-view modelid="648ba1fff756a2285cdd500b" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="block" style="width: 5%;"><!---->
                
                <div data-socialgoodpulse-id="648ba1fff756a2285cdd500b" class="648ba1fff756a2285cdd500b block remove-top-padding remove-padding-bottom background-color-white ">
                    <div class="block__inner">    
                    <base-view type="block" modelid="648ba1fff756a2285cdd500b" model="[object Object]" customclass="" lowercase_component="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="block__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="block__header ">
              <div class="block__header-inner ">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
                        <div class="component__container">                            
                                <!--?lit$370482686$--><!----><opentextbox-view modelid="648ba200f756a2285cdd5027" class="is-full remove-top-padding remove-padding-bottom background-color-white" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="component"><!---->
        <div class="component">
          <div class="component__inner openTextBox__inner">
            <div data-socialgoodpulse-id="648ba200f756a2285cdd5027" class="component opentextbox 648ba200f756a2285cdd5027 remove-top-padding remove-padding-bottom background-color-white is-full   ">
              <div class="component__header-container">
                <div data-socialgoodpulse-id="648ba200f756a2285cdd5027" class="opentabletextbox remove-top-padding remove-padding-bottom background-color-white">
                  <base-view type="component" lowercase_component="openTextBox" model="[object Object]" customclass="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="component__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="component__header openTextBox__header">
              <div class="component__header-inner openTextBox__header-inner">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
                </div>
              </div>
                  <div class="component__widget openTextBox__widget question-container">
                      <!--?lit$370482686$--> <div class="openTextBox__preText"><!--?lit$370482686$-->Research the PHP addslashes() function on the internet. How did it change the input?</div>                         
      
                      <div class="openTextBox__textArea-container">
                          <fieldset class="openTextBox__fieldset" tabindex="0">
                          <legend class="openTextBox__legend">
                            <!--?lit$370482686$-->Answer Area
                          </legend>
                          <textarea class="openTextBox__textArea" rows="3" name="answerArea" placeholder="Enter your answer here" aria-label="Enter your answer here">&lt;!----&gt;&lt;!----&gt;</textarea>
                          </fieldset>
                      </div>
                      <div class="openTextBox__answerText answergray  hide">
                        <!--?lit$370482686$-->
                      <!--?lit$370482686$-->It added slashes before the quotation marks in the alert text. This “escaped” the quotation mark characters and which made them display in the output.
                    </div>

                      <div class="btn__container">                        
                        <!--?lit$370482686$-->                    
                      </div>
                      <!--?lit$370482686$--><!--?-->  
                  </div>
              </div>
            </div>
          </div>
        
      </opentextbox-view><!---->
                            </div>                     
                    </div>
                </div>
            </block-view>
                                <!----><!---->
                                    <block-view modelid="648ba1fff756a2285cdd5009" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="block" style="width: 5%;"><!---->
                
                <div data-socialgoodpulse-id="648ba1fff756a2285cdd5009" class="648ba1fff756a2285cdd5009 block remove-top-padding remove-padding-bottom background-color-white ">
                    <div class="block__inner">    
                    <base-view type="block" modelid="648ba1fff756a2285cdd5009" model="[object Object]" customclass="" lowercase_component="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="block__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="block__header ">
              <div class="block__header-inner ">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
                        <div class="component__container">                            
                                <!--?lit$370482686$--><!----><text-view modelid="648ba200f756a2285cdd5025" class="is-full remove-top-padding remove-padding-bottom background-color-white" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="component"><!---->
        <div class="component__header-container">
            <div data-socialgoodpulse-id="648ba200f756a2285cdd5025" class="component text 648ba200f756a2285cdd5025 remove-top-padding remove-padding-bottom background-color-white is-full   ">
                <base-view type="component" lowercase_component="text" model="[object Object]" customclass="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="component__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="component__header text__header">
              <div class="component__header-inner text__header-inner">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$--> <div class="component__content">
                      <div tabindex="0" class="component__body text__body">
                        <div class="component__body-inner text__body-inner"><!--?lit$370482686$--><p style="margin-left:40px">The second block of code, under <strong>// Sanitize name input</strong>, performs input sanitation on the <strong>Name *</strong> field. It contains the <strong>str_replace()</strong> function which replaces any occurrence of the <strong>&lt;script&gt;</strong> tag with a null value. This disables the script completely.</p><p style="margin-left:40px">We can attempt to bypass the security on the <strong>Name *</strong> field by using some other payload that does not contain <strong>&lt;script&gt;</strong> tags.</p><ol start="8" style="list-style-type:lower-alpha"><li><!--[if !supportLists]-->Close the source code window.</li><li><!--[if !supportLists]--><!--[endif]-->Before entering any payload into the <strong>Name *</strong> field, the max character length restriction of 10 characters on the field must be increased. This is a client-side setting so it is easy to change with the following steps:<ol><li><!--[if !supportLists]--><span>Right-click in the <strong>Name *</strong> field and select <strong>Inspect</strong>. This opens the Web Developer Tools window and displays the page source code</span>.</li><li><!--[if !supportLists]-->Find and double-click <strong>maxlength</strong> in the page source and change it from <strong>10</strong> to <strong>100</strong>. The maxlength property is inside the &lt;input&gt; tag for the text field.</li><li><!--[if !supportLists]-->Press <strong>Enter</strong> on the keyboard to apply the changes.</li><li><!--[if !supportLists]-->Close the Web Developer’s Tools<strong> </strong>Window.</li></ol></li></ol><p style="margin-left:40px"><!--[if !supportLists]-->With the <strong>maxlength</strong> restriction changed, the XSS payload can now be entered into the <strong>Name *</strong> field.</p><p style="margin-left:40px"><strong>Note</strong>: Changing the <strong>maxlength</strong> parameter does not persist. If you refresh the page, for example, the setting needs to be changed again.</p><ol start="10" style="list-style-type:lower-alpha"><li><!--[if !supportLists]-->Return to the Vulnerability page and enter the following payload in the <strong>Name *</strong> field.</li></ol><pre style="margin-left:1in"><strong>&lt;ScRipt&gt;alert("You are hacked!")&lt;/ScRipt&gt;</strong></pre><ol start="11" style="list-style-type:lower-alpha"><li><!--[if !supportLists]--><!--[endif]-->In the <strong>Message *</strong> field you can type any text you like and then click <strong>Sign Guestbook</strong>.</li></ol><p style="margin-left:40px">An XSS alert popup box will appear with the words <strong>You are hacked!</strong>.</p><p style="margin-left:40px">Because the XSS payload is stored in the guestbook, the alert popup box will appear each time the page is refreshed or each time other users visit the page.</p><p style="margin-left:40px">The popup confirms you have successfully exploited Stored XSS vulnerability at the Medium level of security.</p><ol start="12" style="list-style-type:lower-alpha"><li><!--[if !supportLists]-->Before proceeding to the next step, clear the XSS payload from the page. Click<strong> Setup / Reset DB</strong> in the left menu then click <strong>Create / Reset Database</strong>.</li></ol></div>
                      </div>
                    </div>
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
            </div>
        </div>

        <!-- div><div class="component__inner"></div></div -->
        </text-view><!---->
                            </div>                     
                    </div>
                </div>
            </block-view>
                                <!----><!---->
                                    <block-view modelid="648ba1fff756a2285cdd5008" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="block" style="width: 5%;"><!---->
                
                <div data-socialgoodpulse-id="648ba1fff756a2285cdd5008" class="648ba1fff756a2285cdd5008 block remove-top-padding remove-padding-bottom background-color-white ">
                    <div class="block__inner">    
                    <base-view type="block" modelid="648ba1fff756a2285cdd5008" model="[object Object]" customclass="" lowercase_component="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="block__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="block__header ">
              <div class="block__header-inner ">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
                        <div class="component__container">                            
                                <!--?lit$370482686$--><!----><text-view modelid="648ba200f756a2285cdd5024" class="is-full remove-top-padding remove-padding-bottom background-color-white" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="component"><!---->
        <div class="component__header-container">
            <div data-socialgoodpulse-id="648ba200f756a2285cdd5024" class="component text 648ba200f756a2285cdd5024 remove-top-padding remove-padding-bottom background-color-white is-full   ">
                <base-view type="component" lowercase_component="text" model="[object Object]" customclass="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="component__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="component__header text__header">
              <div class="component__header-inner text__header-inner">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$--> <div class="component__content">
                      <div tabindex="0" class="component__body text__body">
                        <div class="component__body-inner text__body-inner"><!--?lit$370482686$--><h3 style="margin-left:0in"><!--[if !supportLists]--><span><span>Step 3: </span></span><!--[endif]-->Perform a Stored XSS attack at High security level.</h3><p>You will attempt the same attack, but this time the security level of the Web site will be set to High.</p><p>At high level the security code whitelists &lt;scripts&gt; and all else is rejected. However, other tags, such as svg will work.</p><ol start="1" style="list-style-type: lower-alpha;"><li><!--[if !supportLists]-->Select <strong>DVWA Security</strong> in the left menu and select <strong>High</strong> in the Security Level dropdown. Click <strong>Submit</strong>.</li><li><!--[if !supportLists]-->Select <strong>XSS (Stored)</strong> in the left menu.</li><li><!--[if !supportLists]-->Type the string <strong>Test#1</strong> in the <strong>Name*</strong> field and type <strong>Stored XSS Test</strong> in the <strong>Message *</strong> field. Click <strong>Sign Guestbook</strong>.</li><li><!--[if !supportLists]-->Enter <strong>CTRL+U</strong> on the keyboard to view the page source code. Enter <strong>CTRL+F</strong> to search for the <strong>Test#1</strong> and <strong>XSS Test</strong> strings.</li></ol><p style="margin-left: 40px;">Both <strong>Test#1</strong> and <strong>XSS Test</strong> should be in the page source code indicating that the two input fields may be vulnerable to a Stored XSS attack.</p><ol start="5" style="list-style-type: lower-alpha;"><li><!--[if !supportLists]--><!--[endif]-->Close the page source code tab and return to the Vulnerability page.</li><li><!--[if !supportLists]-->Enter <strong>Test#1</strong> in the <strong>Name *</strong> box and enter the following payload in the <strong>Message *</strong> box and click <strong>Sign Guestbook</strong>.</li></ol><pre style="margin-left: 80px;"><strong>&lt;ScRipt&gt;alert("You are hacked!")&lt;/ScRipt&gt;</strong></pre><p style="margin-left: 40px;">No popup box will appear. Refreshing the page will not cause the alert popup box to appear either.</p><p style="margin-left: 40px;">This means that there is code in the site backend that is sanitizing the user input from the <strong>Message *</strong> field.</p><ol start="7" style="list-style-type: lower-alpha;"><li><!--[if !supportLists]--><!--[endif]-->Click the <strong>View Source</strong> button and review the PHP source code and investigate.</li></ol><p style="margin-left: 40px;">You will see two blocks of code. As before with the Medium security, the first block of code, under <strong>// Sanitize message input</strong>, contains two php functions for performing input sanitization. The <strong>strip_tags()</strong> function removes all html tags from the message field before storing them in the database. The <strong>htmlspecialchars()</strong> function converts all special characters into equivalent HTML characters so they are not reflected back in the browser.</p><p style="margin-left: 40px;">The second block of code, under <strong>// Sanitize name input</strong>, is performing input sanitation on the <strong>Name *</strong> field. It contains the <strong>preg_replace()</strong> function. This function uses a regular expression to replace any occurrence of the <strong>&lt;script&gt;</strong> tag, regardless of character case, with a null value.</p><p style="margin-left: 40px;">We can attempt to bypass the security on the <strong>Name *</strong> field by using some other payload that does not contain <strong>&lt;script&gt;</strong> tags.</p><ol start="8" style="list-style-type: lower-alpha;"><li><!--[if !supportLists]--><!--[endif]-->Before entering any payload into the <strong>Name *</strong> field, it will be necessary to change the max character length restriction on the field, as was done above.</li></ol><p style="margin-left: 40px;">With the <strong>maxlength</strong> restriction changed, the XSS payload can now be entered into the <strong>Name *</strong> field.</p><ol start="9" style="list-style-type: lower-alpha;"><li><!--[if !supportLists]--><!--[endif]-->Return to the Vulnerability page and enter the following payload in the <strong>Name *</strong> field. (Note the use of underscores to replace spaces.)</li></ol><pre style="margin-left: 80px;"><strong>&lt;svg onload=alert("You_are_hacked!")&gt;</strong></pre><ol start="10" style="list-style-type: lower-alpha;"><li><!--[if !supportLists]-->In the <strong>Message *</strong> field, you can type any text you like and then click <strong>Sign Guestbook</strong>.</li></ol><p style="margin-left: 40px;">An XSS alert popup box will appear with the message "<strong><span>You_are_hacked!</span></strong>".</p><p style="margin-left: 40px;">Because the XSS payload is stored in the guestbook, the alert popup box will appear each time the page is refreshed.</p><p style="margin-left: 40px;">The popup confirms you have successfully exploited a Stored XSS vulnerability at High security level.</p><ol start="11" style="list-style-type: lower-alpha;"><li><!--[if !supportLists]--><!--[endif]-->Before proceeding to the next step, clear the XSS payload from the page. Click<strong> Setup / Reset DB</strong> in the left menu then click <strong>Create / Reset Database</strong>.</li></ol></div>
                      </div>
                    </div>
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
            </div>
        </div>

        <!-- div><div class="component__inner"></div></div -->
        </text-view><!---->
                            </div>                     
                    </div>
                </div>
            </block-view>
                                <!----><!---->
                                    <block-view modelid="648ba1fff756a2285cdd500d" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="block" style="width: 5%;"><!---->
                
                <div data-socialgoodpulse-id="648ba1fff756a2285cdd500d" class="648ba1fff756a2285cdd500d block remove-top-padding remove-padding-bottom background-color-white ">
                    <div class="block__inner">    
                    <base-view type="block" modelid="648ba1fff756a2285cdd500d" model="[object Object]" customclass="" lowercase_component="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="block__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="block__header ">
              <div class="block__header-inner ">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
                        <div class="component__container">                            
                                <!--?lit$370482686$--><!----><text-view modelid="648ba200f756a2285cdd5029" class="is-full remove-top-padding remove-padding-bottom background-color-white" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="component"><!---->
        <div class="component__header-container">
            <div data-socialgoodpulse-id="648ba200f756a2285cdd5029" class="component text 648ba200f756a2285cdd5029 remove-top-padding remove-padding-bottom background-color-white is-full   ">
                <base-view type="component" lowercase_component="text" model="[object Object]" customclass="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="component__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="component__header text__header">
              <div class="component__header-inner text__header-inner">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$--> <div class="component__content">
                      <div tabindex="0" class="component__body text__body">
                        <div class="component__body-inner text__body-inner"><!--?lit$370482686$--><h3 style="margin-left:0in"><!--[if !supportLists]--><span><span>Step 4: </span></span><!--[endif]-->Perform a stored iframe exploit.</h3><ol start="1" style="list-style-type: lower-alpha;"><li><!--[if !supportLists]--><!--[endif]-->Select <strong>DVWA Security</strong> in the left menu and select <strong>Low</strong> in the Security Level dropdown. Click <strong>Submit</strong>.</li><li><!--[if !supportLists]--><!--[endif]-->Select <strong>XSS (Stored)</strong> in the left menu.</li><li><!--[if !supportLists]-->Type the string <strong>iframe</strong> in the <strong>Name*</strong> field and type the following message in the <strong>Message *</strong> field. click <strong>Sign Guestbook</strong>.</li></ol><pre style="margin-left: 80px;"><strong>&lt;iframe src="http://h4cker.org"&gt;&lt;/iframe&gt;</strong></pre><p style="margin-left: 40px;">The H4cker website should now be displayed under the iframe test message.</p><p style="margin-left: 40px;">This is a powerful exploit because the threat actor could send the browser to a malicious website.</p><ol start="4" style="list-style-type: lower-alpha;"><li><!--[if !supportLists]--><!--[endif]-->Before proceeding to the next step, clear the XSS payload from the page. Click<strong> Setup / Reset DB</strong> in the left menu then click <strong>Create / Reset Database</strong>.</li></ol></div>
                      </div>
                    </div>
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
            </div>
        </div>

        <!-- div><div class="component__inner"></div></div -->
        </text-view><!---->
                            </div>                     
                    </div>
                </div>
            </block-view>
                                <!----><!---->
                                    <block-view modelid="648ba1fef756a2285cdd4fff" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="block" style="width: 5%;"><!---->
                
                <div data-socialgoodpulse-id="648ba1fef756a2285cdd4fff" class="648ba1fef756a2285cdd4fff block remove-top-padding remove-padding-bottom background-color-white ">
                    <div class="block__inner">    
                    <base-view type="block" modelid="648ba1fef756a2285cdd4fff" model="[object Object]" customclass="" lowercase_component="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="block__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="block__header ">
              <div class="block__header-inner ">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
                        <div class="component__container">                            
                                <!--?lit$370482686$--><!----><text-view modelid="648ba200f756a2285cdd501b" class="is-full remove-top-padding remove-padding-bottom background-color-white" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="component"><!---->
        <div class="component__header-container">
            <div data-socialgoodpulse-id="648ba200f756a2285cdd501b" class="component text 648ba200f756a2285cdd501b remove-top-padding remove-padding-bottom background-color-white is-full   ">
                <base-view type="component" lowercase_component="text" model="[object Object]" customclass="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="component__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="component__header text__header">
              <div class="component__header-inner text__header-inner">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$--> <div class="component__content">
                      <div tabindex="0" class="component__body text__body">
                        <div class="component__body-inner text__body-inner"><!--?lit$370482686$--><h3 style="margin-left:0in"><!--[if !supportLists]--><span><span>Step 5: </span></span><!--[endif]-->Perform a stored cookie exploit.</h3><p>Stealing the cookies of website visitors has security implications. Cookies contain information about how and when users visit a web site and sometimes authentication information, such as usernames and passwords. Without proper security measures, a threat actor can capture cookies and use them to impersonate specific users and gain access to their information and accounts.</p><ol start="1" style="list-style-type: lower-alpha;"><li><!--[if !supportLists]--><!--[endif]-->Select <strong>DVWA Security</strong> in the left menu and select <strong>Low</strong> in the Security Level options dropdown. Click <strong>Submit</strong>.</li><li><!--[if !supportLists]-->Select <strong>XSS (Stored)</strong> in the left menu.</li><li><!--[if !supportLists]-->Type the string <strong>cookie</strong> in the <strong>Name*</strong> field and type the following message in the <strong>Message *</strong> field. click <strong>Sign Guestbook</strong>.</li></ol><pre style="margin-left: 80px;"><strong><span>&lt;script&gt;alert(document.cookie)&lt;/script&gt;</span></strong></pre><p style="margin-left: 40px;">A popup box with the cookie will be presented. This is a cookie that PHP uses to keep of track of running sessions.</p><p style="margin-left: 40px;">An exploit could modify the XSS script to have the cookie sent to another destination rather than just displaying it.</p><ol start="4" style="list-style-type: lower-alpha;"><li><!--[if !supportLists]-->Click <strong>OK</strong> in the pop-up box.</li><li><!--[if !supportLists]-->Try to steal cookies at the medium and high security levels using techniques that you have learned in this lab.</li></ol></div>
                      </div>
                    </div>
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
            </div>
        </div>

        <!-- div><div class="component__inner"></div></div -->
        </text-view><!---->
                            </div>                     
                    </div>
                </div>
            </block-view>
                                <!----><!---->
                                    <block-view modelid="648ba1fff756a2285cdd500e" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="block" style="width: 5%;"><!---->
                
                <div data-socialgoodpulse-id="648ba1fff756a2285cdd500e" class="648ba1fff756a2285cdd500e block remove-top-padding remove-padding-bottom background-color-white ">
                    <div class="block__inner">    
                    <base-view type="block" modelid="648ba1fff756a2285cdd500e" model="[object Object]" customclass="" lowercase_component="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="block__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="block__header ">
              <div class="block__header-inner ">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
                        <div class="component__container">                            
                                <!--?lit$370482686$--><!----><text-view modelid="648ba200f756a2285cdd502a" class="is-full remove-top-padding remove-padding-bottom background-color-white" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="component"><!---->
        <div class="component__header-container">
            <div data-socialgoodpulse-id="648ba200f756a2285cdd502a" class="component text 648ba200f756a2285cdd502a remove-top-padding remove-padding-bottom background-color-white is-full   ">
                <base-view type="component" lowercase_component="text" model="[object Object]" customclass="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="component__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="component__header text__header">
              <div class="component__header-inner text__header-inner">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$--> <div class="component__content">
                      <div tabindex="0" class="component__body text__body">
                        <div class="component__body-inner text__body-inner"><!--?lit$370482686$--><p><!--[if !supportLists]--><!--[endif]--></p><p><!--[if !supportLists]--></p><h1>Reflection Question</h1></div>
                      </div>
                    </div>
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
            </div>
        </div>

        <!-- div><div class="component__inner"></div></div -->
        </text-view><!---->
                            </div>                     
                    </div>
                </div>
            </block-view>
                                <!----><!---->
                                    <block-view modelid="648ba1fff756a2285cdd5010" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="block" style="width: 5%;"><!---->
                
                <div data-socialgoodpulse-id="648ba1fff756a2285cdd5010" class="648ba1fff756a2285cdd5010 block remove-top-padding remove-padding-bottom background-color-white ">
                    <div class="block__inner">    
                    <base-view type="block" modelid="648ba1fff756a2285cdd5010" model="[object Object]" customclass="" lowercase_component="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="block__header-wrapper remove-top-padding remove-padding-bottom background-color-white ">
        <div class="block__header ">
              <div class="block__header-inner ">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
                        <div class="component__container">                            
                                <!--?lit$370482686$--><!----><opentextbox-view modelid="648ba200f756a2285cdd502c" class="is-full" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme" sgpulse-type="component"><!---->
        <div class="component">
          <div class="component__inner openTextBox__inner">
            <div data-socialgoodpulse-id="648ba200f756a2285cdd502c" class="component opentextbox 648ba200f756a2285cdd502c  is-full   ">
              <div class="component__header-container">
                <div data-socialgoodpulse-id="648ba200f756a2285cdd502c" class="opentabletextbox ">
                  <base-view type="component" lowercase_component="openTextBox" model="[object Object]" customclass="" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"><!---->
      <div class="component__header-wrapper  ">
        <div class="component__header openTextBox__header">
              <div class="component__header-inner openTextBox__header-inner">
                  
                    <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
                  <!--?lit$370482686$-->
              </div>
          </div>
        </div>
      
    </base-view>
                </div>
              </div>
                  <div class="component__widget openTextBox__widget question-container">
                      <!--?lit$370482686$--> <div class="openTextBox__preText"><!--?lit$370482686$-->When conducting an ethical hacking test of a client web application, what does it tell you if the application is vulnerable to XSS at the low, medium, or high level?</div>                         
      
                      <div class="openTextBox__textArea-container">
                          <fieldset class="openTextBox__fieldset" tabindex="0">
                          <legend class="openTextBox__legend">
                            <!--?lit$370482686$-->Answer Area
                          </legend>
                          <textarea class="openTextBox__textArea" rows="3" name="answerArea" placeholder="Enter your answer here" aria-label="Enter your answer here">&lt;!----&gt;&lt;!----&gt;</textarea>
                          </fieldset>
                      </div>
                      <div class="openTextBox__answerText answergray  hide">
                        <!--?lit$370482686$-->
                      <!--?lit$370482686$-->Answers will vary. It should tell you that the application has serious security vulnerabilities and that there are likely other vulnerabilities present. The web application should be evaluated for more damaging vulnerabilities.
                    </div>

                      <div class="btn__container">                        
                        <!--?lit$370482686$-->                    
                      </div>
                      <!--?lit$370482686$--><!--?-->  
                  </div>
              </div>
            </div>
          </div>
        
      </opentextbox-view><!---->
                            </div>                     
                    </div>
                </div>
            </block-view>
                                <!---->
                            </div>
                        </div>
                        <!--?lit$370482686$-->
                    </div>
                </div>
            </div>
        <sgpluse-opentextboxcontroller-view modelid="648ba1fef756a2285cdd4ff4" is-touch="false" fullscreen="true" device="large" browser="Chrome" os="windows" dir="ltr" location="page" theme="dark" orientation="portrait" themetype="article-base-theme"></sgpluse-opentextboxcontroller-view><script></script></body>
<script>
    window.addEventListener("load", function () {
      console.log("loaded");
      document.querySelectorAll(".answergray").forEach(function (ele) {
        ele.classList.add("u-display-none");
      });
      document.querySelectorAll(".hide-answer").forEach(function (ele) {
        ele.classList.add("u-display-none");
      });
      document.querySelectorAll(".show-answer").forEach(function (ele) {
        ele.addEventListener("click", function (e) {
          e.currentTarget.nextElementSibling.classList.remove("u-display-none");
          e.currentTarget
            .closest(".question-container")
            .querySelectorAll(".answergray")
            .forEach(function (ele) {
              ele.classList.remove("u-display-none");
            });
          ele.classList.add("u-display-none");
        });
      });
      document.querySelectorAll(".hide-answer").forEach(function (ele) {
        ele.addEventListener("click", function (e) {
          e.currentTarget.previousElementSibling.classList.remove("u-display-none");
          e.currentTarget
            .closest(".question-container")
            .querySelectorAll(".answergray")
            .forEach(function (ele) {
              ele.classList.add("u-display-none");
            });
          ele.classList.add("u-display-none");
        });
      });
      var event = new Event("click", {
        bubbles: true,
        cancelable: true,
      });
      document
        .querySelectorAll(".openTextBoxController__showButton")
        .forEach(function (ele) {
          ele.addEventListener("click", function (e) {
            e.currentTarget.nextElementSibling.classList.remove("u-display-none");
            ele.classList.add("u-display-none");
            document.querySelectorAll(".show-answer").forEach(function (ele) {
              ele.dispatchEvent(event);
            });
          });
        });

      document
        .querySelectorAll(".openTextBoxController__hideButton")
        .forEach(function (ele) {
          ele.addEventListener("click", function (e) {
            e.currentTarget.previousElementSibling.classList.remove("u-display-none");
            ele.classList.add("u-display-none");
            document.querySelectorAll(".hide-answer").forEach(function (ele) {
              ele.dispatchEvent(event);
            });
          });
        });

      document
        .querySelectorAll(".openTextBoxController__resetButton")
        .forEach(function (ele) {
          ele.addEventListener("click", function (e) {
            document.querySelectorAll("textArea").forEach(function (ele) {
              ele.value = "";
            });
          });
        });
    });
  </script>
  </html>